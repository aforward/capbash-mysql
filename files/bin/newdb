#!/bin/bash
source logging

DATABASE=${DATABASE-$1}
USERNAME=${USERNAME-admin}
PASSWORD=${PASSWORD-yth3fn0t}
HOSTNAME=${HOSTNAME-mysql.local}
CREATE_DB_SQL="/tmp/mysql-newdb-${DATABASE}.sql"

## CREATE USER '$USERNAME'@'$HOSTNAME' IDENTIFIED BY '$PASSWORD';

printf "%b" "#!/bin/bash
CREATE DATABASE IF NOT EXISTS $DATABASE;
GRANT ALL PRIVILEGES ON $DATABASE.* TO '${USERNAME}'@'$HOSTNAME' IDENTIFIED BY '${PASSWORD}' WITH GRANT OPTION;
FLUSH PRIVILEGES;
" > $CREATE_DB_SQL

cat $CREATE_DB_SQL | mysql -u $MYSQL_ADMIN_USERNAME -h $MYSQL_PORT_3306_TCP_ADDR --port $MYSQL_PORT_3306_TCP_PORT -p$MYSQL_ADMIN_PASSWORD
