#!/bin/bash
source logging

DATABASE=${DATABASE-$1}
USERNAME=${USERNAME-admin}
PASSWORD=${PASSWORD-yth3fn0t}
CREATE_DB_SQL="/tmp/mysql-newdb-${DATABASE}.sql"

printf "%b" "#!/bin/bash
CREATE DATABASE IF NOT EXISTS $DATABASE;
CREATE USER '$USERNAME'@'%' IDENTIFIED BY '$PASSWORD';
GRANT ALL ON $DATABASE.* TO '${USERNAME}'@'%' IDENTIFIED BY '${PASSWORD}' WITH GRANT OPTION;
FLUSH PRIVILEGES;
" > $CREATE_DB_SQL

cat $CREATE_DB_SQL | mysql -u $MYSQL_ADMIN_USERNAME -p$MYSQL_ADMIN_PASSWORD
